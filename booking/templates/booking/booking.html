{% load static %}
{% url 'profile_page' as profile_url %}
<!DOCTYPE html>
<html lang="en">
<head>
  {% include "booking/include/_head.html" %}
</head>

<body class="bg-[#F3E7D9]">

<header class="w-full text-white">
  <div class="bg-[#295E70] max-w-6xl mx-auto ">
    <div class="max-w-6xl mx-auto px-6 py-4 flex items-center justify-between">
      <a href="{% url 'home' %}" class="text-3xl font-extrabold tracking-wide text-[#F2BB3A]">
        HIKARI
      </a>

      {% if user.is_authenticated %}
        <a href="{{ profile_url }}"
           class="flex items-center gap-2 bg-white/10 hover:bg-white/20 transition rounded-full px-3 py-2">
          <img src="{% static 'booking/img/icons/login_icon.svg' %}" class="w-5 h-5" alt="">
          <span class="hidden sm:inline">My profile</span>
        </a>
      {% else %}
        <!-- один правый пункт: Sign in -->
        <button type="button"
                data-auth-open="login"
                data-allow-skip="0"
                class="inline-flex items-center gap-2 bg-white/10 hover:bg-white/20 transition rounded-full px-3 py-2">
          <img src="{% static 'booking/img/icons/login_icon.svg' %}" class="w-5 h-5" alt="">
          <span class="hidden sm:inline">Sign in</span>
        </button>
      {% endif %}
    </div>
  </div>

  <div class="relative max-w-6xl mx-auto">
    <img src="{% static 'booking/img/logo/header_decor.png' %}"
         alt="" class="block w-full h-auto object-contain object-bottom pointer-events-none select-none" />
  </div>
</header>

{% include "booking/include/_auth_modal.html" %}

  <main class="max-w-6xl mx-auto px-4 pb-16">
    <div class="grid grid-cols-1 lg:grid-cols-12 gap-6">
      <!-- Форма поиска -->
      <aside class="lg:col-span-3 bg-white/70 rounded-2xl p-4 shadow">
        <h2 class="text-[#295E70] font-bold mb-3">Find a table</h2>
        <form id="searchForm" class="space-y-3">
          <div>
            <label class="text-sm text-[#295E70]">Persons</label>
            <input name="guests" type="number" min="1" max="6" value="2"
                   class="w-full px-4 py-2 border rounded-xl">
          </div>
          <div>
            <label class="text-sm text-[#295E70]">Date</label>
            <input name="date" type="date" class="w-full px-4 py-2 border rounded-xl">
          </div>
          <div>
            <label class="text-sm text-[#295E70]">Time</label>
            <input name="start" type="time" class="w-full px-4 py-2 border rounded-xl">
          </div>
          <div>
            <label class="text-sm text-[#295E70]">Duration</label>
            <select name="duration" class="w-full px-4 py-2 border rounded-xl">
              <option value="60">1 hour</option>
              <option value="90" selected>1.5 hours</option>
              <option value="120">2 hours</option>
            </select>
          </div>
          <button class="mt-2 w-full bg-[#F2BB3A] text-[#1b1f23] font-semibold rounded-xl py-2">
            Search
          </button>
        </form>
      </aside>

      <!-- Карта -->
      <section class="lg:col-span-9">
        <div class="bg-white rounded-2xl p-3 shadow">
          <div id="mapWrap"
               class="relative w-full aspect-[16/9] rounded-xl overflow-hidden border-4 border-[#295E70]"
               data-api-tables="/api/layout/tables/"
               data-api-availability="/api/availability/"
               data-api-me="/api/auth/me/"
               data-api-book="/api/bookings/"
               data-authenticated="{% if request.user.is_authenticated %}1{% else %}0{% endif %}">
            <img src="{% static 'booking/img/tables/booking_map.png' %}"
                 alt="map" class="absolute inset-0 w-full h-full object-cover pointer-events-none">
            <div id="tablesLayer" class="absolute inset-0"></div>
          </div>

          <div class="flex justify-center mt-6">
            <button id="reserveBtn"
                    class="px-8 py-3 rounded-full bg-[#F02D2F] text-white font-semibold disabled:opacity-40"
                    disabled>RESERVE</button>
          </div>
        </div>
      </section>
    </div>

    <!-- TABLE TYPES -->
    <section class="mt-10">
      <div class="flex items-center justify-between">
        <h3 class="text-3xl font-extrabold text-[#295E70]">CHOOSE YOUR VIBE</h3>

  </div>
  <p class="mt-2 text-[#295E70]/75">Choose your atmosphere — by the window, in the center of the hall, or at the bar.</p>

  <div class="grid grid-cols-1 md:grid-cols-3 gap-6 mt-4">
    {% for a in areas %}
      <article class="rounded-2xl overflow-hidden shadow bg-white">
        {% if a.photo %}
          <img src="{{ a.photo.url }}" alt="{{ a.name }}" class="w-full rounded-t-2xl block object-contain">
        {% else %}
          <div class="w-full h-48 bg-[#F3E7D9] flex items-center justify-center text-[#295E70]/60">No photo</div>
        {% endif %}
        <div class="p-4">
          <div class="flex items-center justify-between">
            <h4 class="font-semibold text-[#295E70]">{{ a.name }}</h4>
            <span class="text-xs bg-[#F2BB3A] text-[#1b1f23] rounded-full px-2 py-0.5">Area</span>
          </div>
          {% if a.description %}
            <p class="text-sm text-[#295E70]/80 mt-1">{{ a.description }}</p>
          {% endif %}
        </div>
      </article>
    {% endfor %}
  </div>
</section>
  </main>

  {% include "booking/include/_guest_modal.html" %}

  {% csrf_token %}
  <script src="https://cdn.tailwindcss.com"></script>
  <script src="{% static 'booking/js/auth_modal.js' %}" defer></script>
  <script src="{% static 'booking/js/guest_booking.js' %}" defer></script>
  <script src="{% static 'booking/js/tables/data.js' %}" defer></script>
  <script src="{% static 'booking/js/booking_page.js' %}" defer></script>

</body>
</html>
