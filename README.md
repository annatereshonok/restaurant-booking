# HIKARI ‚Äî —Å–∏—Å—Ç–µ–º–∞ –±—Ä–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏—è —Å—Ç–æ–ª–∏–∫–æ–≤ —Ä–µ—Å—Ç–æ—Ä–∞–Ω–∞

**HIKARI** ‚Äî —ç—Ç–æ –≤–µ–±‚Äë–ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –¥–ª—è –æ–Ω–ª–∞–π–Ω‚Äë–±—Ä–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏—è —Å—Ç–æ–ª–∏–∫–æ–≤ –≤ —Ä–µ—Å—Ç–æ—Ä–∞–Ω–µ.  
–ì–æ—Å—Ç–∏ –º–æ–≥—É—Ç –≤—ã–±—Ä–∞—Ç—å –∑–∞–ª –∏ –≤—Ä–µ–º—è, –æ—Ñ–æ—Ä–º–∏—Ç—å –±—Ä–æ–Ω—å (–≤ —Ç–æ–º —á–∏—Å–ª–µ –±–µ–∑ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏),  
–∞ —Ç–∞–∫–∂–µ —É–ø—Ä–∞–≤–ª—è—Ç—å —Å–≤–æ–∏–º–∏ –±—Ä–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏—è–º–∏ —á–µ—Ä–µ–∑ –ª–∏—á–Ω—ã–π –∫–∞–±–∏–Ω–µ—Ç.  
–ú–µ–Ω–µ–¥–∂–µ—Ä—ã —Ä–µ—Å—Ç–æ—Ä–∞–Ω–∞ –≤–∏–¥—è—Ç —Å–ø–∏—Å–æ–∫ –±—Ä–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–π, –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–∞—é—Ç –∏–ª–∏ –æ—Ç–º–µ–Ω—è—é—Ç –∏—Ö,  
–∏ –ø–æ–ª—É—á–∞—é—Ç —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –ø–æ —ç–ª–µ–∫—Ç—Ä–æ–Ω–Ω–æ–π –ø–æ—á—Ç–µ.

---

## –û—Å–Ω–æ–≤–Ω–æ–π —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª

### –ì–æ—Å—Ç—å (–ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å)
- –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –∏ –≤—Ö–æ–¥ –ø–æ **email + –ø–∞—Ä–æ–ª—å**.
- –ü—Ä–æ—Ñ–∏–ª—å —Å —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ–º –∏–º–µ–Ω–∏, —Ç–µ–ª–µ—Ñ–æ–Ω–∞, –∞–≤–∞—Ç–∞—Ä–∞.
- –ò—Å—Ç–æ—Ä–∏—è –±—Ä–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–π –ø–æ —Å—Ç–∞—Ç—É—Å–∞–º:
  - –û–∂–∏–¥–∞–µ—Ç –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è (pending)
  - –ü–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∞ (confirmed)
  - –ì–æ—Å—Ç—å –Ω–∞ –º–µ—Å—Ç–µ (seated)
  - –ó–∞–≤–µ—Ä—à–µ–Ω–∞ (completed)
  - –û—Ç–º–µ–Ω–µ–Ω–∞ (canceled)
  - –ù–µ –ø—Ä–∏—à–ª–∏ (no_show)
- –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å **–æ—Ç–º–µ–Ω–∏—Ç—å –±—Ä–æ–Ω—å**, –µ—Å–ª–∏ –æ–Ω–∞ –≤ —Å—Ç–∞—Ç—É—Å–µ `pending` –∏–ª–∏ `confirmed`.
- –°–∫–∞—á–∏–≤–∞–Ω–∏–µ —Ñ–∞–π–ª–∞ `.ics` (–¥–æ–±–∞–≤–ª–µ–Ω–∏–µ –≤ –∫–∞–ª–µ–Ω–¥–∞—Ä—å).
- –§–æ—Ä–º–∞ –±—Ä–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏—è —Å –≤—ã–±–æ—Ä–æ–º —Å—Ç–æ–ª–∞, –¥–∞—Ç—ã, –≤—Ä–µ–º–µ–Ω–∏ –∏ –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ –≥–æ—Å—Ç–µ–π.
- –ê–Ω–æ–Ω–∏–º–Ω—ã–µ –±—Ä–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏—è (–±–µ–∑ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏).

### ‚Äç–ú–µ–Ω–µ–¥–∂–µ—Ä —Ä–µ—Å—Ç–æ—Ä–∞–Ω–∞
- –ü–∞–Ω–µ–ª—å –º–µ–Ω–µ–¥–∂–µ—Ä–∞ (`/manager/`).
- –ü—Ä–æ—Å–º–æ—Ç—Ä –±—Ä–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–π –∑–∞ –¥–µ–Ω—å –ø–æ –∑–∞–ª—É.
- –ü–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ / –æ—Ç–º–µ–Ω–∞ / –∏–∑–º–µ–Ω–µ–Ω–∏–µ —Å—Ç–∞—Ç—É—Å–∞ –±—Ä–æ–Ω–∏.

### –ü–æ—á—Ç–æ–≤—ã–µ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è
- –û—Ç–ø—Ä–∞–≤–∫–∞ –ø–∏—Å–µ–º –æ —Å–æ–∑–¥–∞–Ω–∏–∏ –∏ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–∏ –±—Ä–æ–Ω–∏.
- –ù–∞–ø–æ–º–∏–Ω–∞–Ω–∏—è —á–µ—Ä–µ–∑ **Celery + Redis**.
- –ü–æ–¥–¥–µ—Ä–∂–∫–∞ SMTP (Gmail).

### –ò–Ω—Ç–µ—Ä—Ñ–µ–π—Å
- Django Templates + Tailwind CSS.
- –ê–¥–∞–ø—Ç–∏–≤–Ω—ã–π –¥–∏–∑–∞–π–Ω.
- –¶–≤–µ—Ç–æ–≤—ã–µ –º–µ—Ç–∫–∏ –¥–ª—è —Å—Ç–∞—Ç—É—Å–æ–≤ –±—Ä–æ–Ω–∏.
- –í–∫–ª–∞–¥–∫–∏ –ø–æ —Å—Ç–∞—Ç—É—Å–∞–º –≤ –ø—Ä–æ—Ñ–∏–ª–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è.

---

## –¢–µ—Ö–Ω–æ–ª–æ–≥–∏–∏

- **Django 5.0+**, **Django REST Framework**
- **Celery**, **Redis**
- **PostgreSQL / SQLite**
- **Tailwind CDN**
- **Vanilla JS**
- **Docker Compose**

---

## üìÇ –û—Å–Ω–æ–≤–Ω–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

```
booking/
  api/views.py          # API —ç–Ω–¥–ø–æ–∏–Ω—Ç—ã –¥–ª—è –±—Ä–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–π
  tasks.py              # —Ñ–æ–Ω–æ–≤—ã–µ –∑–∞–¥–∞—á–∏ (email, –Ω–∞–ø–æ–º–∏–Ω–∞–Ω–∏—è)
  templates/booking/    # HTML‚Äë—à–∞–±–ª–æ–Ω—ã —Å—Ç—Ä–∞–Ω–∏—Ü –±—Ä–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏—è
  static/booking/       # –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è, –∫–∞—Ä—Ç—ã –∑–∞–ª–æ–≤ –∏ —Ç.–¥.

users/
  api/views.py          # —ç–Ω–¥–ø–æ–∏–Ω—Ç—ã –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏ –∏ –ø—Ä–æ—Ñ–∏–ª—è
  templates/users/      # profile.html
  static/users/js/      # profile.js

config/
  settings.py
  celery.py
  urls.py
```

---

## –§–∏–Ω–∞–ª—å–Ω—ã–µ URL

### –ë—Ä–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ (`booking/api/urls.py`)
```
/api/availability/                            # –ü—Ä–æ–≤–µ—Ä–∫–∞ –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç–∏ —Å—Ç–æ–ª–æ–≤
/api/layout/tables/                           # –°–ø–∏—Å–æ–∫ —Å—Ç–æ–ª–æ–≤
/api/layout/table-types/                      # –¢–∏–ø—ã —Å—Ç–æ–ª–æ–≤
/api/layout/areas/                            # –ó–∞–ª—ã —Ä–µ—Å—Ç–æ—Ä–∞–Ω–∞
/api/bookings/                                # –°–æ–∑–¥–∞–Ω–∏–µ –±—Ä–æ–Ω–∏
/api/me/bookings-by-status/                   # –ë—Ä–æ–Ω–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è (–ø–æ —Å—Ç–∞—Ç—É—Å–∞–º)
/api/me/bookings/<id>/cancel                  # –û—Ç–º–µ–Ω–∞ —Å–≤–æ–µ–π –±—Ä–æ–Ω–∏
/api/me/bookings/<id>/ical                    # –°–∫–∞—á–∞—Ç—å .ics
/api/ical                                     # ICS –ø–æ —Ç–æ–∫–µ–Ω—É (–ø—É–±–ª–∏—á–Ω—ã–π)

# –ú–µ–Ω–µ–¥–∂–µ—Ä—Å–∫–∏–µ —ç–Ω–¥–ø–æ–∏–Ω—Ç—ã
/api/manager/bookings/                        # –°–ø–∏—Å–æ–∫ –±—Ä–æ–Ω–µ–π –∑–∞ –¥–µ–Ω—å
/api/manager/bookings/<id>/confirm            # –ü–æ–¥—Ç–≤–µ—Ä–¥–∏—Ç—å –±—Ä–æ–Ω—å
/api/manager/bookings/<id>/cancel             # –û—Ç–º–µ–Ω–∏—Ç—å –±—Ä–æ–Ω—å
/api/manager/bookings/<id>/status             # –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å —Å—Ç–∞—Ç—É—Å
/api/manager/statuses/                        # –î–æ—Å—Ç—É–ø–Ω—ã–µ —Å—Ç–∞—Ç—É—Å—ã
```

### –ê–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è (`users/api/urls.py`)
```
/api/auth/register/     # –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è
/api/auth/login/        # –í—Ö–æ–¥
/api/auth/logout/       # –í—ã—Ö–æ–¥
/api/auth/me/           # –ü–æ–ª—É—á–∏—Ç—å –¥–∞–Ω–Ω—ã–µ –ø—Ä–æ—Ñ–∏–ª—è
/api/auth/me/update     # –û–±–Ω–æ–≤–∏—Ç—å –ø—Ä–æ—Ñ–∏–ª—å
```

### –°—Ç—Ä–∞–Ω–∏—Ü—ã (`booking/urls.py` + `users/urls.py`)
```
/                   ‚Äî –ì–ª–∞–≤–Ω–∞—è —Å—Ç—Ä–∞–Ω–∏—Ü–∞
/booking/           ‚Äî –°—Ç—Ä–∞–Ω–∏—Ü–∞ –±—Ä–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏—è
/profile/           ‚Äî –õ–∏—á–Ω—ã–π –∫–∞–±–∏–Ω–µ—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
/manager/           ‚Äî –ü–∞–Ω–µ–ª—å –º–µ–Ω–µ–¥–∂–µ—Ä–∞ (—Ç–æ–ª—å–∫–æ staff)
```

---

## .env –ø—Ä–∏–º–µ—Ä

```env
DJANGO_SECRET_KEY=
DJANGO_DEBUG=True
ALLOWED_HOSTS=*
TIME_ZONE=Europe/Moscow

# BD
POSTGRES_DB=restaurant
POSTGRES_USER=postgres
POSTGRES_PASSWORD=postgres
POSTGRES_HOST=db
POSTGRES_PORT=5432

# Redis / Celery
#REDIS_URL=redis://127.0.0.1:6379/0
REDIS_URL=redis://redis:6379/0
CELERY_BROKER_URL=redis://redis:6379/0
CELERY_RESULT_BACKEND=redis://redis:6379/1

SEED_ON_START=true
SEED_FORCE=true

# Booking rules
OPEN_TIME=12:00
CLOSE_TIME=22:00
VISIT_LENGTH_MIN=120
BUFFER_MIN=15

# Email
EMAIL_BACKEND=django.core.mail.backends.smtp.EmailBackend
EMAIL_HOST=smtp.gmail.com
EMAIL_PORT=587
EMAIL_USE_TLS=1
EMAIL_USE_SSL=0
DEFAULT_FROM_EMAIL=
MANAGER_EMAIL=
SITE_BASE_URL=
EMAIL_TIMEOUT=20
EMAIL_HOST_USER=
EMAIL_HOST_PASSWORD=
```

---

## –ó–∞–ø—É—Å–∫ –ø—Ä–æ–µ–∫—Ç–∞

### –ë–µ–∑ Docker

```bash
python -m venv venv
source venv/bin/activate
pip install -r requirements.txt

# –ü—Ä–∏–º–µ–Ω—è–µ–º –º–∏–≥—Ä–∞—Ü–∏–∏ –∏ —Å–æ–∑–¥–∞–µ–º —Å—É–ø–µ—Ä–ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
python manage.py migrate
python manage.py createsuperuser

# –ó–∞–ø—É—Å–∫–∞–µ–º Redis
redis-server
```

#### –ó–∞–ø—É—Å–∫–∞–µ–º –ø—Ä–æ—Ü–µ—Å—Å—ã:
```bash
# –í –æ–¥–Ω–æ–º —Ç–µ—Ä–º–∏–Ω–∞–ª–µ ‚Äî —Å–µ—Ä–≤–µ—Ä Django
python manage.py runserver

# –í –¥—Ä—É–≥–æ–º ‚Äî Celery worker
celery -A config worker -l INFO

# –í —Ç—Ä–µ—Ç—å–µ–º ‚Äî –ø–ª–∞–Ω–∏—Ä–æ–≤—â–∏–∫ –∑–∞–¥–∞—á Celery Beat
celery -A config beat -l INFO
```

---

### –ß–µ—Ä–µ–∑ Procfile (Honcho)

`Procfile`:
```
redis: redis-server
web: python manage.py runserver
worker: celery -A config worker -l INFO
beat: celery -A config beat -l INFO
```

–ó–∞–ø—É—Å–∫:
```bash
pip install honcho
honcho start
```

---

### –ß–µ—Ä–µ–∑ Docker Compose

```bash
docker compose down -v --remove-orphans
docker compose build --no-cache
docker compose up -d
docker compose logs -f
```

–ü–æ—Å–ª–µ —Å–±–æ—Ä–∫–∏ –ø—Ä–æ–µ–∫—Ç –±—É–¥–µ—Ç –¥–æ—Å—Ç—É–ø–µ–Ω –ø–æ –∞–¥—Ä–µ—Å—É: **http://localhost/**

---

## –ò–Ω—Ç–µ—Ä—Ñ–µ–π—Å
- `/` ‚Äî –≥–ª–∞–≤–Ω–∞—è.
- `/booking/` ‚Äî –≤—ã–±–æ—Ä —Å—Ç–æ–ª–∞, –¥–∞—Ç—ã, –≤—Ä–µ–º–µ–Ω–∏.
- `/profile/` ‚Äî –ø—Ä–æ—Ñ–∏–ª—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è, –≤–∫–ª–∞–¥–∫–∏ —Å –±—Ä–æ–Ω—è–º–∏.
- `/manager/` ‚Äî –ø–∞–Ω–µ–ª—å –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞.
- `/admin/` ‚Äî —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–∞—è –∞–¥–º–∏–Ω–∫–∞ Django.

---

## –õ–∏—Ü–µ–Ω–∑–∏—è

MIT (–∏–ª–∏ —É–∫–∞–∂–∏ —Å–≤–æ—é –ø—Ä–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏).
